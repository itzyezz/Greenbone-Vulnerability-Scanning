# Greenebone-Vulnerability-Scanning

In this lab, I will configure accounts with limited privileges that can be used for credentialed vulnerability scanning.

I will be using the community edition of the Greenbone Security Manager (GSM) appliance, which implements the OpenVAS scanner.


# Configure Scan Account Permissions

Here I will configure permissions for a user account to perform scanning. The purpose of the security policy is to prevent its use for local and Remote Desktop log-on and to allow the account to scan the Registry in read-only mode.
<br>
<br>
<br>

From Server Manager, I selected **Tools > Active Directory Users and Computers.** I then selected the Users container.

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/a204adc0-7234-4ae5-a79a-640051bdd169)
<br>
<br>
<br>


I right-clicked Users and selected **New > Group**

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/287c953c-ddee-496b-baa1-1633080582df)
<br>
<br>
<br>

I entered the name **sec-glo-scan**. Group scope selected to **Global** and group type selected to **Security**


![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/96979861-ff14-4386-b89d-23bc0138bd1f)
<br>
<br>
<br>

I right-clicked Users and selected **New > User**

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/57b6dceb-52a3-4c73-99d7-bea9a90df9a7)
<br>
<br>
<br>

In *Full name* and *User logon name* boxes I typed in **scan**

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/3f93e794-0046-487c-bd87-a90eba4113ad)
<br>
<br>
<br>

Typed in the passwords and unchecked **User must change password at next logon** and checked **Password never expires**. Clicked next then finish.
<br>

NOTE: Using non-expiring passwords for service accounts is considered bad practice in many environments. On the other hand, rotating passwords is a significant management task. In AD, you can use managed service accounts (docs.microsoft.com/en-us/services-hub/health/kb-running-assessments-with-msas) to mitigate this issue.

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/81a7c091-6d48-413b-a477-3449f3ce41b8)
<br>
<br>
<br>

Right-clicked the **scan** user and selected **Add to a group**

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/374e3db1-c6de-4791-9fd3-3c835bdd502d)
<br>
<br>
<br>

Typed in **sec-glo-scan** and clicked check names since this was the group we created earlier. After clicking okay you should get a successfully added to group notification. 

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/fe9b22e7-d7c8-4449-959c-6c72fc582288)
<br>
<br>
<br>

On the Windows server manager I clicked on **Tools > Group Policy Management** and expanded the nodes to select **ComputersOU** container. I then right-clicked and selected **Create a GPO in this domain, and Link it here....**

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/fa132cbb-dc34-4e0a-8afd-1889ab55703a)
<br>
<br>
<br>

 In the box, I typed **515support Scanning Policy** and clicked OK. Right-click the policy and select Edit.

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/937848eb-1dc5-4f50-974a-07e7a7e6a34a)
<br>
<br>
<br>

I right-clicked the policy and selected Edit.

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/c486fe42-089f-4974-a3ad-ae7013481b43)
<br>
<br>
<br>

In the *Group Policy Management Editor* console, I expanded **Computer Configuration > Policies > Windows Settings > Security Settings > Restricted Groups**. Right-clicked in the empty pane and selected **Add Group**. I then typed in **sec-glo-scan** then clicked OK.

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/14eead54-4795-4ee5-b3ef-99741d5cecb4)
<br>
<br>
<br>

In the sec-glo-scan Properties dialog, I clicked the **Add** button next to the *This group is a member of:* box.

I typed administrators and clicked OK then clicked OK to close the dialog.

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/56bdf7e4-fe4f-43d7-bd05-021c9128099e)
<br>
<br>
<br>

Expanded **Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > User Rights Assignment.** Double clicked **Deny log on locally.** 

Checked the **Define these policy settings:** box and clicked **Add User or Group.** 

Typed **sec-glo-scan** and clicked OK. Clicked OK to confirm the main dialog.


![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/35276e76-e5f4-4142-9a13-066b55e3d7aa)
<br>
<br>
<br>

Double-clicked **Deny log on through Remote Desktop Services.**

Checked the **Define these policy settings:** box and clicked **Add User or Group.**

Typed **sec-glo-scan** and click OK. Clicked OK to confirm the main dialog.

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/c01d353c-c4d5-4dbc-bcfe-8439ab2af2ce)
<br>
<br>
<br>

Under Security *Settings*, select the **Registry** node. Right-click in the empty pane and select **Add Key.**

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/0c240613-f0e1-4c68-9a25-68c857e7efbd)
<br>
<br>
<br>

Select **USERS** and click OK. 

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/39492ef7-4789-4b1f-a2cc-4e5bf9e27df3)


Click **Advanced** and **Add.** Click **Select a principal.**

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/75373464-4858-47ab-8bd0-780767b0d1eb)

Type **sec-glo-scan** and click OK.

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/da623c3a-6265-4ebd-9745-f3f6572d702b)
<br>
<br>
<br>

From the *Type* box, select **Deny.** From the *Applies to:* list box, ensure **This object and child objects** is selected.

Click **Show advanced permissions.** Check only the following boxes: **Set Value, Create Subkey, Create Link, Delete, Change Permissions, and Take Ownership.** Click OK on all dialog boxes.

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/47a9bd05-16b5-4296-bdbd-96199ff99ca7)
<br>
<br>
<br>

Right-click in the empty pane and select **Add Key.**Select **MACHINE** and click OK.

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/bf6e9d1a-faaa-4052-8274-7785efda5031)
<br>
<br>
<br>

Click **Advanced** and **Add**. Click **Select a principal.** Type **sec-glo-scan** and click OK.

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/49ed0063-afcb-431a-9339-e511c5ccc20c)
<br>
<br>
<br>

Click **Show advanced permissions.** Check only the following boxes: **Set Value, Create Subkey, Create Link, Delete, Change Permissions, and Take Ownership**
Confirm all the dialogs.

Ideally we could configure the same permission for CLASSES_ROOT, but we will skip that for this lab.


# Configure Credentialed Scan Settings

Use the Run dialog to open **iexplore https://10.1.0.243.** At the "not secure" prompt, click More information and then Go on to the webpage to trust the self-signed certificate.

![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/254d3f56-b7d8-4ea2-8974-bf962bb0903c)
![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/b1a151b2-ab35-4676-ba1c-68c6bc23a949)


![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/cb5b81f6-e7dd-456e-8aba-4071217c1eb8)




![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/1ce2232d-20c7-42b8-9008-36fd0ee7b7a7)




![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/3aa6aa5e-15f1-4d65-aeb5-2b5cf0906c70)




![image](https://github.com/itzyezz/Greenebone-Vulnerability-Scanning/assets/105263523/dc678fde-2eb1-4452-bae4-380ae97bf546)







